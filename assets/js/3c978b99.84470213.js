"use strict";(self.webpackChunkcatenax_ng=self.webpackChunkcatenax_ng||[]).push([[631],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>d});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var i=r.createContext({}),c=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=c(e.components);return r.createElement(i.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=c(n),d=a,g=p["".concat(i,".").concat(d)]||p[d]||m[d]||o;return n?r.createElement(g,l(l({ref:t},u),{},{components:n})):r.createElement(g,l({ref:t},u))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,l=new Array(o);l[0]=p;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s.mdxType="string"==typeof e?e:a,l[1]=s;for(var c=2;c<o;c++)l[c]=n[c];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}p.displayName="MDXCreateElement"},8521:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>l,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var r=n(7462),a=(n(7294),n(3905));const o={slug:"Post Mortem 2022-08-29",title:"Post Mortem 2022-08-29",authors:"DevSecOps",tags:["news","post-mortem"]},l=void 0,s={permalink:"/blog/Post Mortem 2022-08-29",editUrl:"https://github.com/catenax-ng/catenax-ng.github.io/blog/PostMortem-2022-08-29.md",source:"@site/blog/PostMortem-2022-08-29.md",title:"Post Mortem 2022-08-29",description:"DEV Environment Inaccessible",date:"2022-08-29T00:00:00.000Z",formattedDate:"August 29, 2022",tags:[{label:"news",permalink:"/blog/tags/news"},{label:"post-mortem",permalink:"/blog/tags/post-mortem"}],readingTime:1.155,hasTruncateMarker:!1,authors:[{name:"DevSecOps Team",title:"Your DevSecOps enabler",url:"https://github.com/catenax-ng",imageURL:"https://avatars.githubusercontent.com/u/100771185?s=200&v=4",key:"DevSecOps"}],frontMatter:{slug:"Post Mortem 2022-08-29",title:"Post Mortem 2022-08-29",authors:"DevSecOps",tags:["news","post-mortem"]},prevItem:{title:"Post Mortem 2022-08-30",permalink:"/blog/Post Mortem 2022-08-30"},nextItem:{title:"Office Hours 2022-8-26",permalink:"/blog/Office Hours 2022-8-26"}},i={authorsImageUrls:[void 0]},c=[{value:"DEV Environment Inaccessible",id:"dev-environment-inaccessible",level:2},{value:"Date",id:"date",level:3},{value:"Authors",id:"authors",level:3},{value:"Status",id:"status",level:3},{value:"Summary",id:"summary",level:3},{value:"Impact",id:"impact",level:3},{value:"Root Causes",id:"root-causes",level:3},{value:"Resolution",id:"resolution",level:3},{value:"Action Items",id:"action-items",level:2},{value:"Lessons Learned",id:"lessons-learned",level:2}],u={toc:c};function m(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"dev-environment-inaccessible"},"DEV Environment Inaccessible"),(0,a.kt)("h3",{id:"date"},"Date"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Start"),(0,a.kt)("th",{parentName:"tr",align:null},"End"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"August 29th 2022, 8:10 CEST"),(0,a.kt)("td",{parentName:"tr",align:null},"29.08.2022, 14:15 CEST")))),(0,a.kt)("h3",{id:"authors"},"Authors"),(0,a.kt)("p",null,"Carsten Lenz, Mercedes-Benz Tech Innovation GmbH"),(0,a.kt)("h3",{id:"status"},"Status"),(0,a.kt)("p",null,"Solved"),(0,a.kt)("h3",{id:"summary"},"Summary"),(0,a.kt)("p",null,"Due to maintenance work the kubernetes ingress controller stopped working. As a result DEV environment seemed to be\ndown."),(0,a.kt)("h3",{id:"impact"},"Impact"),(0,a.kt)("p",null,"All product teams as well as system team where unable to access the Catena-X\nDEV ",(0,a.kt)("a",{parentName:"p",href:"https://argo.dev.demo.catena-x.net"},"ArgoCD instance")),(0,a.kt)("h3",{id:"root-causes"},"Root Causes"),(0,a.kt)("p",null,"Upgrading Azure AKS Kubernetes Cluster to 1.24 introduced a breaking change regarding ingress controller configuration.\nDue to broken Ingress DEV environment was inaccessible."),(0,a.kt)("p",null,"Microsoft has changed protocol for health probing from TCP to HTTP/HTTPS which blocked all HTTP/S traffic as health\nprobing had higher priority over ordinary traffic reaching the cluster."),(0,a.kt)("p",null,"In the end the outage was caused by a missing AKS related annotation for ingress controller, which Microsoft only added\nto the AKS documentation after there were many issues reported to AKS. At time of DEV outage the MS documentation was\nlacking this information."),(0,a.kt)("h3",{id:"resolution"},"Resolution"),(0,a.kt)("p",null,"Adding missing annotation to ingress controller:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},'ingress-nginx:\n  controller:\n    service:\n      annotations:\n        service.beta.kubernetes.io/azure-load-balancer-health-probe-request-path: "/healthz"\n')),(0,a.kt)("h2",{id:"action-items"},"Action Items"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Adherence to internal policies (-> system team)"),(0,a.kt)("li",{parentName:"ul"},"Implement better testing upfront of maintenance tasks"),(0,a.kt)("li",{parentName:"ul"},"Do not upgrade to latest available AKS version")),(0,a.kt)("h2",{id:"lessons-learned"},"Lessons Learned"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"No careless execution of maintenance work"),(0,a.kt)("li",{parentName:"ul"},"Better maintenance planning upfront")))}m.isMDXComponent=!0}}]);